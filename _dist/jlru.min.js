/** ****************************************************************************
 * JLRU v0.0.5
 *
 * An in-memory key/value cache based on the Least Recently Used algorithm.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2019 jclo <jclo@mobilabs.fr> (http://www.mobilabs.fr/).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * ************************************************************************** */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define([""],e):"object"==typeof exports?(module.exports=e(t),null===t.JLRU&&(t.JLRU=e(t))):t.JLRU=e(t)}(this,function(t){"use strict";var e,r,i,u,n,c,s;function l(t){for(;t.lru<t.mru&&void 0===t.list[t.lru];)t.lru+=1}function a(t,e){return new Date-t.cache[e].birth<=t.maxAge}function o(t,e){return{value:t.cache[e].value,age:new Date-t.cache[e].birth}}function h(){s=!1,setTimeout(function(){s=!0},c)}function m(t){c&&s&&(s=!1,h(),t.prune())}return r={isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isBoolean:function(t){return!0===t||!1===t||"[object Boolean]"===Object.prototype.toString.call(t)},isString:function(t){return"[object String]"===Object.prototype.toString.call(t)},isNumber:function(t){return"[object Number]"===Object.prototype.toString.call(t)},isNaN:function(t){return this.isNumber(t)&&t!==+t},isOdd:function(t){var e=t%2;return t===parseFloat(t)?!!e:void 0}},i={set:function(t,e,n,r){var i;return t.cache[e]?r&&!0===r.force&&(i=t.cache[e].stamp,t.cache[e]={value:n,stamp:t.mru,birth:new Date},t.list[t.cache[e].stamp]=e,delete t.list[i],t.mru+=1):(t.cache[e]={value:n,stamp:t.mru,birth:new Date},t.list[t.cache[e].stamp]=e,t.mru+=1,t.items+=1,function(t){for(var e;t.items>t.maxItems;)l(t),e=t.list[t.lru],delete t.cache[e],delete t.list[t.lru],t.items-=1,l(t)}(t)),o(t,e)},get:function(t,e){var n;return t.cache[e]?a(t,e)?(n=o(t,e),t.cache[e].birth=new Date):(this.remove(t,e),n=null):n=null,n},has:function(t,e){return t.cache[e]&&a(t,e)?o(t,e):(this.remove(t,e),null)},remove:function(t,e){var n;return t.cache[e]?(n=t.cache[e].stamp,delete t.cache[e],delete t.list[n],t.items-=1,parseInt(n,10)===t.lru&&(t.lru=-1,l(t)),!0):null},empty:function(t){t.cache={},t.list={},t.lru=0,t.mru=0,t.items=0},dump:function(t){var e,n,r=Object.keys(t.list),i=[];for(n=0;n<r.length;n++)e=t.list[r[n]],i.push({key:e,value:t.cache[e].value,age:new Date-t.cache[e].birth});return i},prune:function(t){var e,n,r,i=Object.keys(t.list),u={};for(r=0;r<i.length;r++)a(t,e=t.list[i[r]])||this.remove(t,e);for(i=Object.keys(t.list),r=0;r<i.length;r++)e=t.list[i[r]],u[n=r.toString()]=e,t.cache[e].stamp=n;t.list=u},renew:function(t,e){return t.cache[e]?(t.cache[e].birth=new Date,o(t,e)):null}},e=function(t){var e,n=Object.create(u);return n.db={},(e=n.db).cache={},e.list={},e.lru=0,e.mru=0,e.items=0,e.maxItems=t&&r.isNumber(t.maxItems)&&0<t.maxItems?Math.ceil(t.maxItems):1e3,e.maxAge=t&&r.isNumber(t.maxAge)&&100<=t.maxAge?Math.ceil(t.maxAge):36e5,(c=t&&r.isNumber(t.prune)&&1e3<=t.prune?Math.ceil(t.prune):null)&&h(),n},n=t.JLRU,e.noConflict=function(){return t.JLRU=n,this},e.VERSION="0.0.5",e._=r,u={set:function(t,e,n){return m(this),r.isString(t)?i.set(this.db,t,e,n):null},get:function(t){return m(this),r.isString(t)?i.get(this.db,t):null},has:function(t){return m(this),r.isString(t)?i.has(this.db,t):null},remove:function(t){return m(this),r.isString(t)?i.remove(this.db,t):null},empty:function(){return i.empty(this.db),this},dump:function(){return m(this),i.dump(this.db)},prune:function(){i.prune(this.db)},count:function(){return m(this),this.db.items},renew:function(t){return m(this),r.isString(t)?i.renew(this.db,t):null}},e});