/** ****************************************************************************
 * JLRU v0.0.2alpha1
 *
 * An in-memory key/value database based on the Least Recently Used algorithm.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2019 jclo <jclo@mobilabs.fr> (http://www.mobilabs.fr/).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * ************************************************************************** */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define([""],e):"object"==typeof exports?module.exports=e(t):t.JLRU=e(t)}(this,function(n){"use strict";var s,a,o;return a={isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isBoolean:function(t){return!0===t||!1===t||"[object Boolean]"===Object.prototype.toString.call(t)},isString:function(t){return"[object String]"===Object.prototype.toString.call(t)},isNumber:function(t){return"[object Number]"===Object.prototype.toString.call(t)},isNaN:function(t){return this.isNumber(t)&&t!==+t},isOdd:function(t){var e=t%2;return t===parseFloat(t)?!!e:void 0}},function(){function u(t){for(;t.lru<t.mru&&void 0===t.list[t.lru];)t.lru+=1}function c(t,e){return new Date-t.cache[e].birth<=t.maxAge}function s(t,e){return{value:t.cache[e].value,age:new Date-t.cache[e].birth}}o={set:function(t,e,n,r){var i;return t.cache[e]?r&&!0===r.force&&(i=t.cache[e].stamp,t.cache[e]={value:n,stamp:t.mru,birth:new Date},t.list[t.cache[e].stamp]=e,delete t.list[i],t.mru+=1):(t.cache[e]={value:n,stamp:t.mru,birth:new Date},t.list[t.cache[e].stamp]=e,t.mru+=1,t.items+=1,function(t){for(var e;t.items>t.maxItems;)u(t),e=t.list[t.lru],delete t.cache[e],delete t.list[t.lru],t.items-=1,u(t)}(t)),s(t,e)},get:function(t,e){var n;return t.cache[e]?c(t,e)?(n=s(t,e),t.cache[e].birth=new Date):(this.remove(t,e),n=null):n=null,n},has:function(t,e){return t.cache[e]&&c(t,e)?s(t,e):(this.remove(t,e),null)},remove:function(t,e){var n;return t.cache[e]?(n=t.cache[e].stamp,delete t.cache[e],delete t.list[n],t.items-=1,parseInt(n,10)===t.lru&&(t.lru=-1,u(t)),!0):null},empty:function(t){t.cache={},t.list={},t.lru=0,t.mru=0,t.items=0},dump:function(t){var e,n,r=Object.keys(t.list),i=[];for(n=0;n<r.length;n++)e=t.list[r[n]],i.push({key:e,value:t.cache[e].value,age:new Date-t.cache[e].birth});return i},prune:function(t){var e,n,r,i=Object.keys(t.list),u={};for(r=0;r<i.length;r++)c(t,e=t.list[i[r]])||this.remove(t,e);for(i=Object.keys(t.list),r=0;r<i.length;r++)e=t.list[i[r]],u[n=r.toString()]=e,t.cache[e].stamp=n;t.list=u},renew:function(t,e){return t.cache[e]?(t.cache[e].birth=new Date,s(t,e)):null}}}(),function(){var r,t,i,e;function u(){e=!1,setTimeout(function(){e=!0},i)}function c(t){i&&e&&(e=!1,u(),t.prune())}s=function(t){var e,n=Object.create(r);return n.db={},(e=n.db).cache={},e.list={},e.lru=0,e.mru=0,e.items=0,e.maxItems=t&&a.isNumber(t.maxItems)&&0<t.maxItems?Math.ceil(t.maxItems):1e3,e.maxAge=t&&a.isNumber(t.maxAge)&&100<=t.maxAge?Math.ceil(t.maxAge):36e5,(i=t&&a.isNumber(t.prune)&&1e3<=t.prune?Math.ceil(t.prune):null)&&u(),n},t=n.JLRU,s.noConflict=function(){return n.JLRU=t,this},s.VERSION="0.0.2alpha1",s._=a,r={set:function(t,e,n){return c(this),a.isString(t)?o.set(this.db,t,e,n):null},get:function(t){return c(this),a.isString(t)?o.get(this.db,t):null},has:function(t){return c(this),a.isString(t)?o.has(this.db,t):null},remove:function(t){return c(this),a.isString(t)?o.remove(this.db,t):null},empty:function(){return o.empty(this.db),this},dump:function(){return c(this),o.dump(this.db)},prune:function(){o.prune(this.db)},count:function(){return c(this),this.db.items},renew:function(t){return c(this),a.isString(t)?o.renew(this.db,t):null}}}(),s});